{"version":3,"file":"live.js","sourceRoot":"","sources":["../../../src/util/accessibility/live.ts"],"names":[],"mappings":"AAAA,OAAO,EAAC,UAAU,EAAE,MAAM,EAAE,cAAc,EAAY,MAAM,eAAe,CAAC;AAC5E,OAAO,EAAC,QAAQ,EAAC,MAAM,iBAAiB,CAAC;AAOzC,MAAM,CAAC,IAAM,eAAe,GAAG,IAAI,cAAc,CAAuB,sBAAsB,CAAC,CAAC;AAChG,MAAM,CAAC,IAAM,uBAAuB,GAAyB,GAAG,CAAC;AAIjE,wBAAwB,QAAa,EAAE,UAAkB;IAAlB,2BAAA,EAAA,kBAAkB;IACvD,IAAI,OAAO,GAAG,QAAQ,CAAC,IAAI,CAAC,aAAa,CAAC,WAAW,CAAgB,CAAC;IAEtE,EAAE,CAAC,CAAC,OAAO,IAAI,IAAI,IAAI,UAAU,CAAC,CAAC,CAAC;QAClC,OAAO,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;QAExC,OAAO,CAAC,YAAY,CAAC,IAAI,EAAE,UAAU,CAAC,CAAC;QACvC,OAAO,CAAC,YAAY,CAAC,WAAW,EAAE,QAAQ,CAAC,CAAC;QAC5C,OAAO,CAAC,YAAY,CAAC,aAAa,EAAE,MAAM,CAAC,CAAC;QAE5C,OAAO,CAAC,SAAS,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC;QAEjC,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC;KACpC;IAED,MAAM,CAAC,OAAO,CAAC;CAChB;;IAMC,cAAsC,WAAiD;QAAjD,cAAS,GAAT,SAAS;QAAwC,WAAM,GAAN,MAAM;KAAS;IAEtG,0BAAW,GAAX;QACE,IAAM,OAAO,GAAG,cAAc,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;QAC/C,EAAE,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC;YACZ,OAAO,CAAC,aAAa,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC;SAC5C;KACF;IAED,kBAAG,GAAH,UAAI,OAAe;QACjB,IAAM,OAAO,GAAG,cAAc,CAAC,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC,CAAC;QACrD,IAAM,KAAK,GAAG,IAAI,CAAC,MAAM,CAAC;QAE1B,OAAO,CAAC,WAAW,GAAG,EAAE,CAAC;QACzB,IAAM,OAAO,GAAG,cAAM,OAAA,OAAO,CAAC,WAAW,GAAG,OAAO,EAA7B,CAA6B,CAAC;QACpD,EAAE,CAAC,CAAC,KAAK,KAAK,IAAI,CAAC,CAAC,CAAC;YACnB,OAAO,EAAE,CAAC;SACX;QAAC,IAAI,CAAC,CAAC;YACN,UAAU,CAAC,OAAO,EAAE,KAAK,CAAC,CAAC;SAC5B;KACF;;gBAtBF,UAAU;;;;gDAEI,MAAM,SAAC,QAAQ;gDAA2B,MAAM,SAAC,eAAe;;eAnC/E;;SAkCa,IAAI","sourcesContent":["import {Injectable, Inject, InjectionToken, OnDestroy} from '@angular/core';\nimport {DOCUMENT} from '@angular/common';\n\n\n\n// usefulness (and default value) of delay documented in Material's CDK\n// https://github.com/angular/material2/blob/6405da9b8e8532a7e5c854c920ee1815c275d734/src/cdk/a11y/live-announcer/live-announcer.ts#L50\nexport type ARIA_LIVE_DELAY_TYPE = number | null;\nexport const ARIA_LIVE_DELAY = new InjectionToken<ARIA_LIVE_DELAY_TYPE>('live announcer delay');\nexport const DEFAULT_ARIA_LIVE_DELAY: ARIA_LIVE_DELAY_TYPE = 100;\n\n\n\nfunction getLiveElement(document: any, lazyCreate = false): HTMLElement | null {\n  let element = document.body.querySelector('#ngb-live') as HTMLElement;\n\n  if (element == null && lazyCreate) {\n    element = document.createElement('div');\n\n    element.setAttribute('id', 'ngb-live');\n    element.setAttribute('aria-live', 'polite');\n    element.setAttribute('aria-atomic', 'true');\n\n    element.classList.add('sr-only');\n\n    document.body.appendChild(element);\n  }\n\n  return element;\n}\n\n\n\n@Injectable()\nexport class Live implements OnDestroy {\n  constructor(@Inject(DOCUMENT) private _document: any, @Inject(ARIA_LIVE_DELAY) private _delay: any) {}\n\n  ngOnDestroy() {\n    const element = getLiveElement(this._document);\n    if (element) {\n      element.parentElement.removeChild(element);\n    }\n  }\n\n  say(message: string) {\n    const element = getLiveElement(this._document, true);\n    const delay = this._delay;\n\n    element.textContent = '';\n    const setText = () => element.textContent = message;\n    if (delay === null) {\n      setText();\n    } else {\n      setTimeout(setText, delay);\n    }\n  }\n}\n"]}